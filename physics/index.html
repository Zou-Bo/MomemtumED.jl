<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Physics Background · MomentumED.jl</title><meta name="title" content="Physics Background · MomentumED.jl"/><meta property="og:title" content="Physics Background · MomentumED.jl"/><meta property="twitter:title" content="Physics Background · MomentumED.jl"/><meta name="description" content="Documentation for MomentumED.jl."/><meta property="og:description" content="Documentation for MomentumED.jl."/><meta property="twitter:description" content="Documentation for MomentumED.jl."/><meta property="og:url" content="https://Zou-Bo.github.io/MomentumED.jl/physics/"/><meta property="twitter:url" content="https://Zou-Bo.github.io/MomentumED.jl/physics/"/><link rel="canonical" href="https://Zou-Bo.github.io/MomentumED.jl/physics/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MomentumED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api/">API Reference</a></li><li class="is-active"><a class="tocitem" href>Physics Background</a><ul class="internal"><li><a class="tocitem" href="#Momentum-Conservation"><span>Momentum Conservation</span></a></li><li><a class="tocitem" href="#Many-Body-State-Representation"><span>Many-Body State Representation</span></a></li><li><a class="tocitem" href="#Hamiltonian-Construction"><span>Hamiltonian Construction</span></a></li><li><a class="tocitem" href="#Multi-Component-Systems"><span>Multi-Component Systems</span></a></li><li><a class="tocitem" href="#Entanglement-Entropy"><span>Entanglement Entropy</span></a></li><li><a class="tocitem" href="#Berry-Connection"><span>Berry Connection</span></a></li><li><a class="tocitem" href="#KrylovKit-Integration"><span>KrylovKit Integration</span></a></li><li><a class="tocitem" href="#Momentum-Mesh-Shift"><span>Momentum Mesh Shift</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../performance/">Performance Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Physics Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Physics Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Zou-Bo/MomentumED.jl/blob/main/docs/src/physics.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Physics-Implementation"><a class="docs-heading-anchor" href="#Physics-Implementation">Physics Implementation</a><a id="Physics-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-Implementation" title="Permalink"></a></h1><p>This document describes the physics concepts implemented in the package.</p><h2 id="Momentum-Conservation"><a class="docs-heading-anchor" href="#Momentum-Conservation">Momentum Conservation</a><a id="Momentum-Conservation-1"></a><a class="docs-heading-anchor-permalink" href="#Momentum-Conservation" title="Permalink"></a></h2><p>The package exploits translational symmetry to block-diagonalize the Hamiltonian by total momentum sectors. A momemtum-unconserved Hamiltonian will cause errors.</p><h3 id="Block-Division"><a class="docs-heading-anchor" href="#Block-Division">Block Division</a><a id="Block-Division-1"></a><a class="docs-heading-anchor-permalink" href="#Block-Division" title="Permalink"></a></h3><p>The Hilbert space is divided into blocks with identical total momentum:</p><pre><code class="language-julia hljs">blocks, block_k1, block_k2, k0number = ED_momentum_block_division(para, mbs_list)</code></pre><p>This reduces the eigenvalue problem size from the full Hilbert space to individual momentum blocks.</p><h2 id="Many-Body-State-Representation"><a class="docs-heading-anchor" href="#Many-Body-State-Representation">Many-Body State Representation</a><a id="Many-Body-State-Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Many-Body-State-Representation" title="Permalink"></a></h2><h3 id="Bit-Encoding"><a class="docs-heading-anchor" href="#Bit-Encoding">Bit Encoding</a><a id="Bit-Encoding-1"></a><a class="docs-heading-anchor-permalink" href="#Bit-Encoding" title="Permalink"></a></h3><p>Many-body states are represented using bit strings:</p><pre><code class="language-julia hljs">struct MBS64{bits} &lt;: Integer
    n::UInt64
end</code></pre><ul><li>Each bit represents orbital occupation (0 = empty, 1 = occupied)</li><li><code>bits</code> parameter determines maximum system size (up to 64 orbitals)</li><li>Efficient bitwise operations for state manipulation</li></ul><h3 id="State-Operations"><a class="docs-heading-anchor" href="#State-Operations">State Operations</a><a id="State-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#State-Operations" title="Permalink"></a></h3><p>The MBS64 type provides basic operations for bit manipulation:</p><pre><code class="language-julia hljs"># Create a 4-bit state with orbitals 1 and 3 occupied
mbs = MBS64{4}(0b1010)  # Binary representation

# Access the underlying integer
state_value = mbs.n</code></pre><h2 id="Hamiltonian-Construction"><a class="docs-heading-anchor" href="#Hamiltonian-Construction">Hamiltonian Construction</a><a id="Hamiltonian-Construction-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonian-Construction" title="Permalink"></a></h2><h3 id="Scattering-Formalism"><a class="docs-heading-anchor" href="#Scattering-Formalism">Scattering Formalism</a><a id="Scattering-Formalism-1"></a><a class="docs-heading-anchor-permalink" href="#Scattering-Formalism" title="Permalink"></a></h3><p>The Hamiltonian is constructed using abstract N-body scattering terms:</p><pre><code class="language-julia hljs">struct Scattering{N}
    Amp::ComplexF64
    out::NTuple{N, Int64}
    in::NTuple{N, Int64}
end

# One-body: V * c†_i c_j
s1 = Scattering(1.0-1.0im, 1, 2)  # Creates c†_1 c_2 term

# Two-body: V * c†_i1 c†_i2 c_j2 c_j1  
s2 = Scattering(0.5, 1, 2, 4, 3)  # Creates c†_1 c†_2 c_4 c_3 term</code></pre><h3 id="Scattering-List-Generation"><a class="docs-heading-anchor" href="#Scattering-List-Generation">Scattering List Generation</a><a id="Scattering-List-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Scattering-List-Generation" title="Permalink"></a></h3><p>The package generates sorted lists of scattering terms:</p><pre><code class="language-julia hljs"># One-body terms from EDPara.H_onebody matrix
scat_list1 = ED_sortedScatteringList_onebody(para)

# Two-body terms from interaction function
scat_list2 = ED_sortedScatteringList_twobody(para)</code></pre><h2 id="Multi-Component-Systems"><a class="docs-heading-anchor" href="#Multi-Component-Systems">Multi-Component Systems</a><a id="Multi-Component-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Component-Systems" title="Permalink"></a></h2><h3 id="Component-Indexing"><a class="docs-heading-anchor" href="#Component-Indexing">Component Indexing</a><a id="Component-Indexing-1"></a><a class="docs-heading-anchor-permalink" href="#Component-Indexing" title="Permalink"></a></h3><p>The package handles additional quantum numbers beyond momentum:</p><pre><code class="language-julia hljs"># Global orbital index mapping
global_index = k + Nk * (ch - 1) + Nk * Nch * (cc - 1)</code></pre><p>Where:</p><ul><li><code>k</code>: momentum index (1 to Nk)</li><li><code>ch</code>: hopping channel index (1 to Nc_hopping)</li><li><code>cc</code>: conserved component index (1 to Nc_conserve)</li></ul><h3 id="One-body-Terms"><a class="docs-heading-anchor" href="#One-body-Terms">One-body Terms</a><a id="One-body-Terms-1"></a><a class="docs-heading-anchor-permalink" href="#One-body-Terms" title="Permalink"></a></h3><p>Stored in 4D array: <code>H_onebody[ch1, ch2, cc, k]</code></p><ul><li>Represents hopping between channels <code>ch2 → ch1</code></li><li>Conserves component index <code>cc</code></li><li>Momentum index <code>k</code> is conserved</li></ul><h3 id="Two-body-Interactions"><a class="docs-heading-anchor" href="#Two-body-Interactions">Two-body Interactions</a><a id="Two-body-Interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-body-Interactions" title="Permalink"></a></h3><p>Custom interaction functions receive momentum coordinates and component indices:</p><pre><code class="language-julia hljs">function V_int(k_coords_f1, k_coords_f2, k_coords_i1, k_coords_i2, cf1=1, cf2=1, ci1=1, ci2=1)
    # k_coords_*: Tuple{Float64, Float64} momentum coordinates
    # cf1, cf2: final component indices
    # ci1, ci2: initial component indices
    # Return complex scattering amplitude
end</code></pre><p>The function receives momentum coordinates already shifted and normalized by the Gk vector.</p><h2 id="Entanglement-Entropy"><a class="docs-heading-anchor" href="#Entanglement-Entropy">Entanglement Entropy</a><a id="Entanglement-Entropy-1"></a><a class="docs-heading-anchor-permalink" href="#Entanglement-Entropy" title="Permalink"></a></h2><p>The package computes entanglement entropy for bit-position bipartitions:</p><pre><code class="language-julia hljs"># Create bit mask for subsystem A (first 2 bits)
bit_mask = MBS64{bits}(0b0011)

# Compute entanglement entropy
entropy = ED_etg_entropy(block, eigenvector, bit_mask)

# Rényi entropy of order 2
entropy_2 = ED_etg_entropy(block, eigenvector, bit_mask, alpha=2.0)</code></pre><h3 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h3><ul><li>Uses bit masking to identify subsystem A and B</li><li>Direct computation without storing reduced density matrix</li><li>Computes von Neumann entropy: <code>S = -Tr(ρ_A log ρ_A)</code></li><li>Supports Rényi entropy: <code>S_α = (1-α)^(-1) log Tr(ρ_A^α)</code></li><li>Automatically computes RDM for smaller subsystem for efficiency</li></ul><h2 id="Berry-Connection"><a class="docs-heading-anchor" href="#Berry-Connection">Berry Connection</a><a id="Berry-Connection-1"></a><a class="docs-heading-anchor-permalink" href="#Berry-Connection" title="Permalink"></a></h2><p>For topological analysis, the package computes many-body Berry connections between kshift points:</p><pre><code class="language-julia hljs"># Calculate geometric phase between two kshift points
geometric_phase = ED_connection_integral(kshift1, kshift2, ψ1, ψ2, momentum_axis_angle)

# Calculate Berry connection (average connection)
berry_conn = ED_connection_integral(kshift1, kshift2, ψ1, ψ2, momentum_axis_angle; average_connection=true)</code></pre><h3 id="Implementation-2"><a class="docs-heading-anchor" href="#Implementation-2">Implementation</a><a class="docs-heading-anchor-permalink" href="#Implementation-2" title="Permalink"></a></h3><ul><li>Computes complex inner product: <code>⟨ψ2|ψ1⟩</code></li><li>Extracts geometric phase: <code>φ = arg(⟨ψ2|ψ1⟩)</code></li><li>Berry connection: <code>A = φ / ||δk||</code></li><li>Accounts for non-orthogonal momentum space coordinates</li><li>Handles numerical stability for very close points</li></ul><h2 id="KrylovKit-Integration"><a class="docs-heading-anchor" href="#KrylovKit-Integration">KrylovKit Integration</a><a id="KrylovKit-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#KrylovKit-Integration" title="Permalink"></a></h2><p>The package uses KrylovKit for sparse matrix diagonalization:</p><pre><code class="language-julia hljs"># Sparse matrix construction from scattering terms
H = HmltMatrix_threaded(block, scat_list1, scat_list2, multi_thread)

# KrylovKit eigensolve
vals, vecs, info = eigsolve(H, vec0, N_eigen, :SR, ishermitian=true)</code></pre><h3 id="Convergence-Control"><a class="docs-heading-anchor" href="#Convergence-Control">Convergence Control</a><a id="Convergence-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence-Control" title="Permalink"></a></h3><p>The eigensolver includes:</p><ul><li>Random initial vector for good convergence</li><li>Convergence warning system</li><li>Support for different eigenvalue selections (<code>:SR</code>, <code>:LR</code>, <code>:LM</code>)</li><li>Automatic handling of convergence failures</li></ul><h2 id="Momentum-Mesh-Shift"><a class="docs-heading-anchor" href="#Momentum-Mesh-Shift">Momentum Mesh Shift</a><a id="Momentum-Mesh-Shift-1"></a><a class="docs-heading-anchor-permalink" href="#Momentum-Mesh-Shift" title="Permalink"></a></h2><p>The package supports twisted boundary conditions via k-mesh shift:</p><pre><code class="language-julia hljs"># Apply momentum shift to interaction amplitudes
amp = int_amp(i1, i2, f1, f2, para; kshift=(0.1, 0.2))</code></pre><h3 id="Implementation-3"><a class="docs-heading-anchor" href="#Implementation-3">Implementation</a><a class="docs-heading-anchor-permalink" href="#Implementation-3" title="Permalink"></a></h3><ul><li>Shifts momentum coordinates: <code>(k_list .+ kshift) ./ Gk</code></li><li>Maintains backward compatibility with default <code>(0.0, 0.0)</code></li><li>Affects all momentum-dependent calculations in interaction functions</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API Reference</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 10 September 2025 17:19">Wednesday 10 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
